<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Social Media Content Analyzer</title>
    <link rel="stylesheet" href="style.css" />
    <!--  PDF.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <!-- Tesseract.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- Header Section -->
      <header class="app-header">
        <h1>🚀 Social Media Content Analyzer</h1>
        <p>
          Extract text from PDFs and images, then optimize your content for
          social media platforms
        </p>
      </header>

      <!-- Upload Section -->
      <section class="upload-section" id="uploadSection">
        <div class="upload-area" id="uploadArea">
          <div class="upload-content">
            <div class="upload-icon">📁</div>
            <h3>Drop files here or click to upload</h3>
            <p>Support for PDF files and images (PNG, JPG, JPEG).</p>
            <p class="file-size-info">Maximum file size: 10MB per file</p>
            <div class="upload-buttons">
              <button class="btn btn--primary" id="selectFileBtn">
                📂 Select Files
              </button>
              <button class="btn btn--secondary" id="browseBtn">
                🔍 Browse
              </button>
            </div>
          </div>
          <!--  File input with proper attributes -->
          <input
            type="file"
            id="fileInput"
            accept=".pdf,.png,.jpg,.jpeg,.gif,.bmp,.tiff,.webp"
            multiple
            style="display: none"
          />
        </div>

        <!-- Error display -->
        <div class="file-error hidden" id="fileError"></div>
      </section>

      <!-- Processing Section -->
      <section class="processing-section hidden" id="processingSection">
        <div class="card">
          <div class="card__body">
            <h3>🔄 Processing Files...</h3>
            <div class="progress-container">
              <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
              </div>
              <p class="progress-text" id="progressText">Preparing...</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Results Section with Extracted Text Display -->
      <section class="results-section hidden" id="resultsSection">
        <!-- File Processing Summary -->
        <div class="card" id="fileProcessingSummary">
          <!-- Summary will be populated by JavaScript -->
        </div>

        <!-- Extracted Text Display Section -->
        <div class="card" id="extractedTextSection">
          <div class="card__header">
            <h3>📄 Extracted Text</h3>
            <button class="btn btn--copy" id="copyBtn">📋 Copy All Text</button>
          </div>
          <div class="card__body">
            <div class="extracted-text-container">
              <pre id="extractedText" class="extracted-text">
No text extracted yet. Upload a file to see results here.</pre
              >
            </div>
            <div class="text-actions">
              <button class="btn btn--secondary btn--copy">📋 Copy Text</button>
              <button class="btn btn--secondary" onclick="selectAllText()">
                🔍 Select All
              </button>
              <span class="text-info" id="textInfo">0 characters</span>
            </div>
          </div>
        </div>

        <!-- Content Metrics -->
        <div class="card">
          <div class="card__header">
            <h3>📊 Content Metrics</h3>
          </div>
          <div class="card__body">
            <div class="metrics-grid" id="contentMetrics">
              <!-- Metrics will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Sentiment Analysis -->
        <div class="card">
          <div class="card__header">
            <h3>🎭 Sentiment Analysis</h3>
          </div>
          <div class="card__body">
            <div id="sentimentAnalysis">
              <!-- Sentiment analysis will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Platform Analysis -->
        <div class="card">
          <div class="card__header">
            <h3>📱 Platform Optimization</h3>
          </div>
          <div class="card__body">
            <div class="platform-grid" id="platformAnalysis">
              <!-- Platform analysis will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Hashtag Suggestions -->
        <div class="card">
          <div class="card__header">
            <h3>#️⃣ Hashtag Suggestions</h3>
          </div>
          <div class="card__body">
            <div id="hashtagSuggestions">
              <!-- Hashtag suggestions will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Improvement Suggestions -->
        <div class="card">
          <div class="card__header">
            <h3>💡 Improvement Suggestions</h3>
          </div>
          <div class="card__body">
            <div class="suggestions-grid" id="improvementSuggestions">
              <!-- Improvement suggestions will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="card">
          <div class="card__header">
            <h3>🔧 Actions</h3>
          </div>
          <div class="card__body">
            <div class="action-buttons">
              <button class="btn btn--primary" onclick="location.reload()">
                🔄 Analyze New Files
              </button>
              <button class="btn btn--secondary btn--copy">
                📋 Copy All Text
              </button>
              <button class="btn btn--secondary" onclick="downloadResults()">
                💾 Download Results
              </button>
              <button class="btn btn--secondary" onclick="shareResults()">
                📤 Share Analysis
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="app-footer">
        <p>&copy; Made By Priyansu Tripathi.</p>
      </footer>
    </div>

    <!-- Load the application JavaScript -->
    <script src="app.js"></script>

    <!-- Additional utility functions -->
    <script>
      // Select all text in the extracted text area
      function selectAllText() {
        const textElement = document.getElementById("extractedText");
        if (textElement && textElement.textContent.trim()) {
          const range = document.createRange();
          range.selectNodeContents(textElement);
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
          showNotification(
            "Text selected! Use Ctrl+C (or Cmd+C) to copy.",
            "info"
          );
        } else {
          showNotification("No text available to select", "warning");
        }
      }

      // Download results as text file
      function downloadResults() {
        const extractedText =
          document.getElementById("extractedText")?.textContent;
        if (!extractedText || !extractedText.trim()) {
          showNotification("No text available to download", "warning");
          return;
        }

        try {
          // Create analysis summary
          const contentMetrics =
            document.getElementById("contentMetrics")?.textContent || "";
          const sentiment =
            document.getElementById("sentimentAnalysis")?.textContent || "";
          const hashtags = Array.from(document.querySelectorAll(".hashtag"))
            .map((el) => el.textContent)
            .join(" ");

          const analysisReport = `SOCIAL MEDIA CONTENT ANALYZER - RESULTS
================================================

EXTRACTED TEXT:
${extractedText}

CONTENT METRICS:
${contentMetrics}

SENTIMENT ANALYSIS:
${sentiment}

SUGGESTED HASHTAGS:
${hashtags}

Generated on: ${new Date().toLocaleString()}
`;

          const blob = new Blob([analysisReport], { type: "text/plain" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `social-media-analysis-${Date.now()}.txt`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);

          showNotification("Analysis downloaded successfully!", "success");
        } catch (error) {
          console.error("Download error:", error);
          showNotification("Failed to download results", "error");
        }
      }

      // Share results (basic implementation)
      function shareResults() {
        const extractedText =
          document.getElementById("extractedText")?.textContent;
        if (!extractedText || !extractedText.trim()) {
          showNotification("No text available to share", "warning");
          return;
        }

        if (navigator.share) {
          navigator
            .share({
              title: "Social Media Content Analysis",
              text:
                extractedText.substring(0, 200) +
                (extractedText.length > 200 ? "..." : ""),
              url: window.location.href,
            })
            .then(() => {
              showNotification("Shared successfully!", "success");
            })
            .catch((err) => {
              console.error("Share failed:", err);
              copyToClipboard(extractedText);
            });
        } else {
          // Fallback: copy to clipboard
          copyToClipboard(extractedText);
          showNotification("Text copied to clipboard for sharing!", "info");
        }
      }

      // Update text info when extracted text changes
      function updateTextInfo() {
        const textElement = document.getElementById("extractedText");
        const textInfoElement = document.getElementById("textInfo");

        if (textElement && textInfoElement) {
          const text = textElement.textContent || "";
          const charCount = text.length;
          const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;

          textInfoElement.textContent = `${charCount.toLocaleString()} characters • ${wordCount.toLocaleString()} words`;
        }
      }

      // Initialize text info updates
      document.addEventListener("DOMContentLoaded", () => {
        // Update text info when content changes
        const observer = new MutationObserver(updateTextInfo);
        const textElement = document.getElementById("extractedText");
        if (textElement) {
          observer.observe(textElement, {
            childList: true,
            subtree: true,
            characterData: true,
          });
        }
      });
    </script>
  </body>
</html>
